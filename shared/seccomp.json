{
    "_comment": "Docker seccomp profile for sq-sandbox. Based on Docker's default profile with additional blocks on syscalls that sandbox code should never need. Keeps mount, ptrace, clone allowed since the host process needs them for sandbox management.",
    "defaultAction": "SCMP_ACT_ERRNO",
    "defaultErrnoRet": 1,
    "syscalls": [
        {
            "names": [
                "accept", "accept4", "access", "adjtimex", "alarm",
                "bind", "brk",
                "capget", "capset", "chdir", "chmod", "chown", "chroot",
                "clock_adjtime", "clock_getres", "clock_gettime", "clock_nanosleep",
                "clone", "clone3", "close", "connect", "copy_file_range",
                "creat",
                "dup", "dup2", "dup3",
                "epoll_create", "epoll_create1", "epoll_ctl", "epoll_ctl_old",
                "epoll_pwait", "epoll_pwait2", "epoll_wait", "epoll_wait_old",
                "eventfd", "eventfd2", "execve", "execveat", "exit", "exit_group",
                "faccessat", "faccessat2", "fadvise64", "fallocate", "fanotify_init",
                "fanotify_mark", "fchdir", "fchmod", "fchmodat", "fchmodat2",
                "fchown", "fchownat", "fcntl", "fdatasync", "fgetxattr",
                "flistxattr", "flock", "fork", "fremovexattr", "fsetxattr",
                "fstat", "fstatfs", "fsync", "ftruncate", "futex", "futex_waitv",
                "futimesat",
                "get_robust_list", "get_thread_area", "getcpu", "getcwd",
                "getdents", "getdents64", "getegid", "geteuid", "getgid",
                "getgroups", "getitimer", "getpeername", "getpgid", "getpgrp",
                "getpid", "getppid", "getpriority", "getrandom", "getresgid",
                "getresuid", "getrlimit", "getrusage", "getsid", "getsockname",
                "getsockopt", "gettid", "gettimeofday", "getuid", "getxattr",
                "inotify_add_watch", "inotify_init", "inotify_init1",
                "inotify_rm_watch", "io_cancel", "io_destroy", "io_getevents",
                "io_pgetevents", "io_setup", "io_submit", "io_uring_enter",
                "io_uring_register", "io_uring_setup", "ioctl", "ioprio_get",
                "ioprio_set",
                "ipc",
                "kill",
                "lchown", "lgetxattr", "link", "linkat", "listen",
                "listxattr", "llistxattr", "lremovexattr", "lseek",
                "lsetxattr", "lstat",
                "madvise", "membarrier", "memfd_create", "memfd_secret",
                "mincore", "mkdir", "mkdirat", "mknod", "mknodat", "mlock",
                "mlock2", "mlockall", "mmap", "mount", "mprotect",
                "mq_getsetattr", "mq_notify", "mq_open", "mq_timedreceive",
                "mq_timedsend", "mq_unlink", "mremap", "msgctl", "msgget",
                "msgrcv", "msgsnd", "msync", "munlock", "munlockall", "munmap",
                "name_to_handle_at", "nanosleep", "newfstatat",
                "open", "open_by_handle_at", "openat", "openat2",
                "pause", "pidfd_open", "pidfd_send_signal", "pipe", "pipe2",
                "pivot_root", "pkey_alloc", "pkey_free", "pkey_mprotect",
                "poll", "ppoll", "prctl", "pread64", "preadv", "preadv2",
                "prlimit64", "ptrace", "pwrite64", "pwritev", "pwritev2",
                "read", "readahead", "readlink", "readlinkat", "readv",
                "reboot",
                "recvfrom", "recvmmsg", "recvmsg", "remap_file_pages",
                "removexattr", "rename", "renameat", "renameat2",
                "restart_syscall", "rmdir", "rseq",
                "rt_sigaction", "rt_sigpending", "rt_sigprocmask",
                "rt_sigqueueinfo", "rt_sigreturn", "rt_sigsuspend",
                "rt_sigtimedwait", "rt_tgsigqueueinfo",
                "sched_get_priority_max", "sched_get_priority_min",
                "sched_getaffinity", "sched_getattr", "sched_getparam",
                "sched_getscheduler", "sched_rr_get_interval",
                "sched_setaffinity", "sched_setattr", "sched_setparam",
                "sched_setscheduler", "sched_yield",
                "seccomp", "select", "semctl", "semget", "semop",
                "semtimedop", "sendfile", "sendmmsg", "sendmsg", "sendto",
                "set_robust_list", "set_thread_area", "set_tid_address",
                "setfsgid", "setfsuid", "setgid", "setgroups", "setitimer",
                "setns", "setpgid", "setpriority", "setregid", "setresgid",
                "setresuid", "setreuid", "setrlimit", "setsid", "setsockopt",
                "setuid", "setxattr",
                "shmat", "shmctl", "shmdt", "shmget", "shutdown",
                "sigaltstack", "signalfd", "signalfd4",
                "socket", "socketcall", "socketpair", "splice",
                "stat", "statfs", "statx", "symlink", "symlinkat",
                "sync", "sync_file_range", "syncfs", "sysinfo", "syslog",
                "tee", "tgkill", "time", "timer_create", "timer_delete",
                "timer_getoverrun", "timer_gettime", "timer_settime",
                "timerfd_create", "timerfd_gettime", "timerfd_settime",
                "times", "tkill", "truncate",
                "umask", "umount2", "uname", "unlink", "unlinkat",
                "unshare", "utime", "utimensat", "utimes",
                "vfork", "vhangup", "vmsplice",
                "wait4", "waitid", "waitpid", "write", "writev"
            ],
            "action": "SCMP_ACT_ALLOW"
        },
        {
            "names": [
                "kexec_load",
                "kexec_file_load",
                "init_module",
                "finit_module",
                "delete_module",
                "bpf",
                "perf_event_open",
                "process_vm_readv",
                "process_vm_writev",
                "userfaultfd",
                "kcmp",
                "lookup_dcookie",
                "add_key",
                "keyctl",
                "request_key"
            ],
            "action": "SCMP_ACT_ERRNO",
            "errnoRet": 1,
            "comment": "Dangerous syscalls that sandbox code should never need"
        }
    ]
}
